target main(compile) {}

target compile(analyze, test) {
  # TODO enable cache checks
  run("rm -rf build");
  run("mkdir build");
  run("dart compile exe ./bin/micro_build.dart -o build/mb");
}

target analyze(packages) {
  run("dart analyze . --fatal-warnings --fatal-infos");
}

target test(packages) {
  run("dart test --reporter=expanded --concurrency=1");
}

target packages() {
  run("dart pub get");
}
